<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IIR tool</title>
</head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
<script src= "{{ url_for('js', path='/annotator.min.js') }}" ></script>
<link rel="stylesheet" href="{{ url_for('js', path='/annotator.min.css') }}">
<body>
    <center><h1>IIR Tool</h1></center>
    </form>
    <form action="/uploadfiles/" enctype="multipart/form-data" method="post">
    <input name="file" type="file" multiple>
    <input type="submit">
    </form>

    <h3>File Name: </h3> <p>{{ filename }}</p>

    <h3>Extracted Text</h3> <br>

    <p class ="test" id="foo" name="annotate_text" >{{ text }}gsfdsfgds</p>
   
    <br>

    </form>
    <form action="/download/annotations">
  
    <input type="submit" value="Download annotations"></input>
    </form>

    <form action="/download/ocrtext">
  
    <input type="submit" value="Download text"></input>
    </form>
    
    
</body>
<script>
// function custom_ui_main(){
//   return {
//         start: function (app) {
//             app.notify("Hello, geeks!");
//         }
//     };
// }
var custom_ui_main = function () {
    var element = document.querySelector("#relativeLocation");
    var makeAnnotation = UtilityService.annotationFactory(element, ".annotator-hl");
    var ui = { interactionPoint: null };
    return {start: function start() 
        {ui.highlighter = new annotator.ui.highlighter.Highlighter(element);
            ui.textselector = new annotator.ui.textselector.TextSelector(element, 
                {onSelection: function onSelection(ranges, event) 
                    {if (ranges.length > 0)
                        {annotation = makeAnnotation(ranges);
                        var commentModalPosition = UtilityService.mousePosition(event);
                        // document.getElementById("commentEditContainer").style.display = "block";
                    } }});},destroy: function destroy() 
                    {ui.highlighter.destroy();ui.textselector.destroy();},
                    annotationCreated: function annotationCreated(a)
                     {ui.highlighter.draw(a);},
                     annotationsLoaded: function annotationsLoaded(a) 
                     {ui.highlighter.drawAll(a).then(
                         function () {},
                         annotationDeleted: function annotationDeleted(a)
                          {ui.highlighter.undraw(a);},
                          annotationUpdated: function annotationUpdated(a) {
                              ui.highlighter.redraw(a);}};}
var app = new annotator.App();
    app.include(annotator.ui.main);
    app.include(annotator.storage.http);
    // app.start();
    app
    .start()
    .then(function () {
        app.annotations.load();
    });

    // var app = new annotator.App();
    // app.include(annotator.ui.main);
    // app.include(annotator.storage.http);
    // app
    // .start()
    // .then(function () {
    //     app.annotations.load();
    // });

    // var content = $('#foo').annotator();

    // jQuery(function ($) {
    //     $('#foo').annotator()
    //     .annotator('setupPlugins', {}, {
    //                // Disable the tags plugin
    //                Tags: false,
    //                // Filter plugin options
    //                Filter: {
    //                  addAnnotationFilter: false, // Turn off default annotation filter
    //                  filters: [{label: 'Quote', property: 'quote'}] // Add a quote filter
    //                }
    //              });
    // });

    // var ann = new Annotator(document.body); 
    
    // ann.start();
    // if (typeof annotator === 'undefined') {
    //     alert("Oops! it looks like you haven't built Annotator. " +
    //           "Either download a tagged release from GitHub, or build the " +
    //           "package by running `make`");
    //   } else {
    //     var app = new annotator.App();
    //     app.include(annotator.ui.main);
    //     app.start();
    //   }


//    function getSelectedText(){
//        console.log("hello")
//     var selectedText = '';
//     // var window = Window.getWindow();
//     // if(window.getSelection.baseNode.parentNode.id != "foo") return;
//     // window.getSelection
//     console.log(window.getSelection().anchorNode.parentNode)
//     console.log(window.getSelection().anchorNode.parentNode.className);
//     console.log(window.getSelection().anchorNode.parentNode.id)
//     if (window.getSelection) {
//         selectedText = window.getSelection();
        
//         var range = selectedText.getRangeAt(0);
//         var newNode = document.createElement("span");
//         newNode.setAttribute("style", "background-color: pink;");
//         range.surroundContents(newNode); 
//     }
//     // // document.getSelection
//     else  if (document.getSelection) {
//         selectedText = document.getSelection();
//     }
//     // document.selection
//     else if (document.selection) {
//         selectedText = 
//         document.selection.createRange().text;
//     } else return;
//     // To write the selected text into the textarea
//     document.testform.selectedtext.value = selectedText;
//    }

</script>
</html>